# åŸºç¡€ç¯‡

> ***æ³¨é‡ï¼šç®—æ³•ã€æ•°æ®ç»“æ„ã€å¸¸è§çš„è®¾è®¡æ¨¡å¼***

## ç®—æ³•éƒ¨åˆ†

- æŒæ¡å¸¸è§æ’åºç®—æ³•ï¼ˆäºŒåˆ†ã€å†’æ³¡ã€å¿«æ’ã€é€‰æ‹©ã€æ’å…¥ç­‰ï¼‰
- æ‰‹å†™å†’æ³¡ã€å¿«æ’çš„ä»£ç 
- äº†è§£å„ä¸ªæ’åºç®—æ³•çš„ç‰¹æ€§ï¼Œå¦‚æ—¶é—´å¤æ‚åº¦ã€æ˜¯å¦ç¨³å®š

------



### 1.äºŒåˆ†æŸ¥æ‰¾

**è¦æ±‚**

* èƒ½å¤Ÿç”¨è‡ªå·±è¯­è¨€æè¿°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•

    - ç­”ï¼š`äºŒåˆ†æŸ¥æ‰¾å°±æ˜¯ç”¨ä¸­é—´å€¼çš„æ•°ä¸ç›®æ ‡æ•°åšå¯¹æ¯”ï¼Œå¦‚æœè®¡ç®—å‡ºç›®æ ‡æ•°æ¯”ä¸­é—´æ•°å¤§ï¼Œåˆ™è¯´æ˜ç›®æ ‡æ•°åœ¨ä¸­é—´æ•°åˆ°æœ€å³ç«¯ä¹‹é—´ï¼Œåä¹‹åˆ™å°ã€‚`
    - ç®—æ³•æ€æƒ³`å¯è§æœ€å·¦ç«¯å’Œæœ€å³ç«¯æ˜¯ä¸¤ä¸ªå˜é‡ï¼Œéœ€è¦é€šè¿‡è¿™ä¸¤ä¸ªå˜é‡æ¥æ§åˆ¶æ•´ä¸ªç®—æ³•è¿›è¡Œï¼Œæ­£å¸¸æƒ…å†µåˆ™æ˜¯å·¦ç«¯ä¸€å®šè¦å°äºç­‰äºå³ç«¯æ‰ä¸æ–­çš„è¿›è¡Œå¾ªç¯ï¼Œåæ­£ç®—æ³•ç»“æŸã€‚`
* èƒ½å¤Ÿæ‰‹å†™äºŒåˆ†æŸ¥æ‰¾ä»£ç 
* å¿«é€Ÿè§£ç­”äºŒåˆ†æŸ¥æ‰¾çš„é€‰æ‹©é¢˜
* èƒ½å¤Ÿè§£ç­”ä¸€äº›å˜åŒ–åçš„è€ƒæ³•



**ç®—æ³•æè¿°**

1. å‰æï¼šæœ‰å·²æ’åºæ•°ç»„ Aï¼ˆå‡è®¾å·²ç»åšå¥½ï¼‰

2. å®šä¹‰å·¦è¾¹ç•Œ Lã€å³è¾¹ç•Œ Rï¼Œç¡®å®šæœç´¢èŒƒå›´ï¼Œå¾ªç¯æ‰§è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼ˆ3ã€4ä¸¤æ­¥ï¼‰

3. è·å–ä¸­é—´ç´¢å¼• M = Floor((L+R) /2)  `Flooræ˜¯å‘ä¸‹å–æ•´çš„æ„æ€`

4. ä¸­é—´ç´¢å¼•çš„å€¼  A[M] ä¸å¾…æœç´¢çš„å€¼ T è¿›è¡Œæ¯”è¾ƒ

   â‘  A[M] == T è¡¨ç¤ºæ‰¾åˆ°ï¼Œè¿”å›ä¸­é—´ç´¢å¼•

   â‘¡ A[M] > Tï¼Œä¸­é—´å€¼å³ä¾§çš„å…¶å®ƒå…ƒç´ éƒ½å¤§äº Tï¼Œæ— éœ€æ¯”è¾ƒï¼Œä¸­é—´ç´¢å¼•å·¦è¾¹å»æ‰¾ï¼ŒM - 1 è®¾ç½®ä¸ºå³è¾¹ç•Œï¼Œé‡æ–°æŸ¥æ‰¾

   â‘¢ A[M] < Tï¼Œä¸­é—´å€¼å·¦ä¾§çš„å…¶å®ƒå…ƒç´ éƒ½å°äº Tï¼Œæ— éœ€æ¯”è¾ƒï¼Œä¸­é—´ç´¢å¼•å³è¾¹å»æ‰¾ï¼Œ M + 1 è®¾ç½®ä¸ºå·¦è¾¹ç•Œï¼Œé‡æ–°æŸ¥æ‰¾

5. å½“ L => R æ—¶ï¼Œè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°ï¼Œåº”ç»“æŸå¾ªç¯

*[æ›´å½¢è±¡çš„å›¾ç¤ºæ¼”ç¤ºè¯·å‚è€ƒ ğŸ‘‰ æ¼”ç¤ºåŠ¨ç”»](docs/md/Serious-eight-part-essay/JAVA/binary_search.html)*

**ç®—æ³•å®ç°å’Œæµ‹è¯•ï¼š**ï¼ˆä»¥jdké‡Œçš„Arrays.binarySearch()æ–¹æ³•æ¥å®ç°ï¼‰

```java
public class BinarySearch {
    // æµ‹è¯•
    public static void main(String[] args) {
        BinarySearch binarySearch = new BinarySearch();
        int[] array = {1, 12, 23, 54, 55, 66, 67, 80, 99};
        int temp = 55;
        String shuo = binarySearch.binarySearch(array,temp);
        System.out.println(shuo);
    }
    // ç®—æ³•å®ç°
    public String binarySearch(int [] array,int temp) {
        int l =0;   int r =array.length-1;
        while (l<=r) {
            int model = (l+r) / 2;
            if (temp == array[model]) {
                return "æ˜¯è¿™ä¸ªæ•°    "+temp;
            } else if (temp > array[model]) {
               l=model+1;

            } else if(temp < array[model]){
                r=model-1;
            }
        }
        return "æ²¡æ‰¾ç€";
    }
}

```

**è§£å†³æ•´æ•°æº¢å‡ºé—®é¢˜**

> *æº¢å‡ºè¿‡ç¨‹è¯¦è§£*ï¼š

```java
public static void main(String[] args) {
        int left = 0;
        int right = Integer.MAX_VALUE - 1;
        int middle = (left + right) / 2;
        System.out.println(right);//2147483646
        System.out.println(middle);//1073741823
        // å¾—å‡ºä¸­é—´å€¼ä¸º m = 10äº¿å¤šï¼Œå¦‚æœæ¥ä¸‹æ¥å†è®¡ç®—ï¼ˆint m =(l+r)/2 ï¼‰ï¼Œåˆ™ä¼šç»§ç»­è¿›è¡Œ l+r è¿ç®—ï¼Œå°±ç­‰äº30äº¿å¤šäº†ï¼Œè¶…å‡ºäº†intçš„æœ€å¤§å€¼ã€‚
//        ä¸¾ä¾‹å­
//        åœ¨å³ä¾§
        left = middle + 1;
        middle = (left + right) / 2;
        System.out.println(middle);//-536870913
//        äºŒè¿›åˆ¶è¿ç®—ï¼Œæ¼”ç¤ºä¸¤ä¸ªæ­£æ•´æ•°ç›¸åŠ å˜æˆè´Ÿæ•°ï¼Œè§„åˆ™ï¼šé€¢ 2 è¿› 1ï¼Œä¸º 2 æ˜¯ 0.
//        æ¯”å¦‚ 126 + 63 è§„å®šåœ¨ä¸€ä¸ªbyteï¼ˆ8ä¸ªbitï¼‰å†…ä¸”æœ‰ç¬¦å·ï¼Œ åˆ™ç»“æœä¸æ˜¯ 189ï¼Œè€Œæ˜¯ -67
//         ç¬¦å·ä½ï¼Œ0ä»£è¡¨æ­£->   0 1 1 1  1 1 1 0      å€¼ä¸º126
//                        +  0 0 1 1  1 1 1 1      å€¼ä¸º63
//                           1 0 1 1  1 1 0 1      å€¼ä¸º-67
//
//        æ–¹æ³•ä¸€ï¼š (l + r)/2 ==> l - l/2 + r/2 ==> l + (r/2 - l/2) ==> l + (r-l)/2    åˆ©ç”¨å¤§å€¼å…ˆå‡å»å·¦è¾¹ç•Œåå…ˆé™¤ä»¥2ï¼Œè¿™æ ·å³ä½¿å†åŠ ä¸Šå·¦è¾¹ç•Œä¹Ÿå°äº†
        middle = left + (right - left) / 2;
        System.out.println(middle);//1610612735
//        æ–¹æ³•äºŒï¼›  ç”¨æ— ç¬¦å·çš„å³ç§»è¿ç®—ä»£æ›¿æ‰é™¤æ³•ã€‚  å‘å³ç§»ä¸€ä½
        middle = (left + right) >>> 1;
        System.out.println(middle);
    }
```

å½“ l å’Œ r éƒ½è¾ƒå¤§æ—¶ï¼Œ`l + r` æœ‰å¯èƒ½è¶…è¿‡æ•´æ•°èŒƒå›´ï¼Œé€ æˆè¿ç®—é”™è¯¯ï¼Œè§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š

ç›¸å…³é¢è¯•é¢˜
1 ï¼æœ‰ä¸€ä¸ªæœ‰åºè¡¨ä¸º 1 , 5 , 8 , 11 , 19 , 22 , 31 , 35 , 40 , 45 , 48 , 49 , 50 å½“äºŒåˆ†æŸ¥æ‰¾å€¼ä¸º 48 çš„ç»“ç‚¹æ—¶ï¼ŒæŸ¥æ‰¾æˆåŠŸéœ€è¦æ¯”è¾ƒçš„æ¬¡æ•°() 

2 ï¼ä½¿ç”¨äºŒåˆ†æ³•åœ¨åºåˆ— 1 , 4 , 6 , 7 , 15 , 33 , 39 , 50 , 64 , 78 , 75 , 81 , 89 , 96 ä¸­æŸ¥æ‰¾å…ƒç´  81 æ—¶ï¼Œéœ€è¦ç»è¿‡ï¼ˆï¼‰æ¬¡æ¯”è¾ƒ 
> å£è¯€ï¼š
> å¥‡æ•°äºŒåˆ†å–ä¸­é—´
> å¶æ•°äºŒåˆ†å–ä¸­é—´é å·¦

3 ï¼åœ¨æ‹¥æœ‰ä¸€ä¸ª 128 ä¸ªå…ƒç´ çš„æ•°ç»„ä¸­äºŒåˆ†æŸ¥æ‰¾ä¸€ä¸ªæ•°ï¼Œéœ€è¦æ¯”è¾ƒçš„æ¬¡æ•°æœ€å¤šä¸è¶…è¿‡å¤šå°‘æ¬¡  
-  $2^n$   = 128 æˆ– 128 /2 /2....ç›´åˆ° 1
-  é—®é¢˜è½¬åŒ–ä¸º$log_2 128=7$, è®¡ç®—å™¨åˆ™æ˜¯ $log_10 128/$log_10 2 = 7$  å››èˆäº”å…¥å–æ•´ã€‚

   - æ˜¯æ•´æ•°ï¼Œåˆ™æ•´æ•°å³ä¸ºæœ€ç»ˆç»“æœ
   
   - æ˜¯å°æ•°ï¼Œåˆ™èˆå»å°æ•°éƒ¨åˆ†ï¼Œæ•´æ•°åŠ ä¸€ä¸ºæœ€ç»ˆç»“æœ
   

------

### 2. å†’æ³¡æ’åº

**è¦æ±‚**

* èƒ½å¤Ÿç”¨è‡ªå·±è¯­è¨€æè¿°å†’æ³¡æ’åºç®—æ³•
* èƒ½å¤Ÿæ‰‹å†™å†’æ³¡æ’åºä»£ç 
* äº†è§£ä¸€äº›å†’æ³¡æ’åºçš„ä¼˜åŒ–æ‰‹æ®µ

**ç®—æ³•æè¿°**

1. ä¾æ¬¡æ¯”è¾ƒæ•°ç»„ä¸­ç›¸é‚»ä¸¤ä¸ªå…ƒç´ å¤§å°ï¼Œè‹¥ a[j] > a[j+1]ï¼Œåˆ™äº¤æ¢ä¸¤ä¸ªå…ƒç´ ï¼Œä¸¤ä¸¤éƒ½æ¯”è¾ƒä¸€éç§°ä¸ºä¸€è½®å†’æ³¡ï¼Œç»“æœæ˜¯è®©æœ€å¤§çš„å…ƒç´ æ’è‡³æœ€å
2. é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ•´ä¸ªæ•°ç»„æœ‰åº

**ç®—æ³•å®ç°**ï¼ˆä¼˜åŒ–`å¤–å±‚`å¾ªç¯çš„å¾ªç¯æ¯”è¾ƒæ¬¡æ•°â€”â€”æ’å¥½åºçš„æ•°ç»„ä¸éœ€è¦å†å¾ªç¯æ¯”è¾ƒï¼‰

```java
public class Test {
    public static void main(String[] args) {
        int[] array = {5, 9, 7, 4, 1, 3, 2, 8};
        bubble(array);
    }

    public static void bubble(int[] array) {
        int k;
        for (int j = 0; j < array.length - 1 - j; j++) { // array.length- 1- jæ¯è½®å°‘æ¯”ä¸€æ¬¡
            boolean swapped = false;// æ˜¯å¦å‘ç”Ÿäº†äº¤æ¢ï¼Œé¿å…å·²æ’å¥½åºåˆåšäº¤æ¢æ“ä½œï¼Œæå‡ç®—æ³•æ•ˆç‡
//        ç¬¬ä¸€è½®æ’åºâ€”â€”â€”â€”æŒ‘å‡ºæœ€å¤§çš„æ’åœ¨æœ€å³è¾¹
            for (int i = 0; i < array.length - 1; i++) {
                 System.out.println("æ¯”è¾ƒæ¬¡æ•°"+i);
                if (array[i] > array[i + 1]) {
                    swap(array, i, i + 1);
                }
            }
            k=j+1;
            System.out.println("ç¬¬" + k + "è½®" + Arrays.toString(array));
            if (!swapped) {
                break;
            }
        }
    }

    public static void swap(int[] array, int i, int j) {
        int t = array[i];
        array[i] = array[j];
        array[j] = t;
    }
}
```

**æœ€ä¼˜ç®—æ³•å®ç°**ï¼ˆä¼˜åŒ–`å†…å±‚`å¾ªç¯çš„å¾ªç¯æ¯”è¾ƒæ¬¡æ•°â€”â€”æ•°ç»„å…ƒç´ ä¸­åå‡ ä½æ¯”è¾ƒå®Œçš„å…ƒç´ æ— éœ€å†æ¯”è¾ƒï¼‰

- ä¼˜åŒ–æ–¹å¼ï¼šæ¯è½®å†’æ³¡æ—¶ï¼Œæœ€åä¸€æ¬¡äº¤æ¢ç´¢å¼•å¯ä»¥ä½œä¸ºä¸‹ä¸€è½®å†’æ³¡çš„æ¯”è¾ƒæ¬¡æ•°ï¼Œå¦‚æœè¿™ä¸ªå€¼ä¸ºé›¶ï¼Œè¡¨ç¤ºæ•´ä¸ªæ•°ç»„æœ‰åºï¼Œç›´æ¥é€€å‡ºå¤–å±‚å¾ªç¯å³å¯ã€‚

```java
 public static void bubble_2(int[] array) {
        int n = array.length - 1;//æ¯”è¾ƒå¾ªç¯çš„æ¬¡æ•°
        while (true) {
            int last = 0;// æœ€åä¸€æ¬¡å‘ç”Ÿäº¤æ¢æ—¶çš„ç´¢å¼•ä½ç½®
            for (int i = 0; i < n; i++) {
                System.out.println("æ¯”è¾ƒæ¬¡æ•°"+i);
                if (array[i] > array[i + 1]) {
                    swap(array, i, i + 1);
                    last = i;// æ¯æ¬¡å¾ªç¯åè®°å½•æœ€åä¸€æ¬¡äº¤æ¢çš„ç´¢å¼•ä½ç½®

                }
            }
            n = last;
            System.out.println("ç¬¬"+n+"è½®å¾ªç¯å†’æ³¡æ’åº"+Arrays.toString(array));
            if (0 == n) {
                break;
            }
        }
    }
```

### 3. é€‰æ‹©æ’åº

**è¦æ±‚**

* èƒ½å¤Ÿç”¨è‡ªå·±è¯­è¨€æè¿°é€‰æ‹©æ’åºç®—æ³•
* èƒ½å¤Ÿæ¯”è¾ƒé€‰æ‹©æ’åºä¸å†’æ³¡æ’åº
* ç†è§£éç¨³å®šæ’åºä¸ç¨³å®šæ’åº

**ç®—æ³•æè¿°**

1. å°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­é›†ï¼Œæ’åºçš„å’Œæœªæ’åºçš„ï¼Œæ¯ä¸€è½®ä»æœªæ’åºçš„å­é›†ä¸­é€‰å‡ºæœ€å°çš„å…ƒç´ ï¼Œæ”¾å…¥æ’åºå­é›†

2. é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ•´ä¸ªæ•°ç»„æœ‰åº

<!-- **ç®—æ³•æ€è·¯è§£æï¼š**

1.ç¡®å®šæ•°ç»„éœ€è¦ç»è¿‡å¤šå°‘è½®é€‰æ‹©æ‰èƒ½è®©æ•°ç»„æœ‰åº 	eg:å‡è®¾æ•°ç»„é•¿åº¦æ˜¯8ï¼Œåˆ™éœ€è¦ç»è¿‡7è½®é€‰æ‹©ï¼Œå¯ä»¥é€‰å‡ºå‰7ä¸ªæ•°æ”¾å…¥åˆ°æœ‰åºéƒ¨åˆ†ï¼Œå‰©ä¸‹çš„é‚£ä¸ªæ— éœ€å†é€‰å°±æ˜¯æœ€å¤§çš„äº†ã€‚

2.æ¯è½®å¾ªç¯åº”æŸ¥å‡ºçš„æ•°æ˜¯ä»€ä¹ˆ

3.
-->

3. ä¼˜åŒ–æ–¹å¼

1.ä¸ºå‡å°‘äº¤æ¢æ¬¡æ•°ï¼Œæ¯ä¸€è½®å¯ä»¥å…ˆæ‰¾æœ€å°çš„ç´¢å¼•ï¼Œåœ¨æ¯è½®æœ€åå†äº¤æ¢å…ƒç´ ã€‚

4. ä¸å†’æ³¡æ’åºæ¯”è¾ƒ

  - 1.äºŒè€…å¹³å‡æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯Oï¼ˆn`2ï¼‰.
  - 2.é€‰æ‹©æ’åºä¸€èˆ¬è¦å¿«äºå†’æ³¡ï¼Œå› ä¸ºå…¶äº¤æ¢æ¬¡æ•°å°‘ã€‚
  - ä½†å¦‚æœé›†åˆæœ‰åºåº¦é«˜ï¼Œå†’æ³¡ä¼˜äºé€‰æ‹©
  - å†’æ³¡å±äºç¨³å®šæ’åºç®—æ³•ï¼Œè€Œé€‰æ‹©å±äºä¸ç¨³å®šæ’åºã€‚

```java
public class Test {
    public static void main(String[] args) {
        int[] array = {5, 3, 7, 2, 1, 9, 8, 4};
        selection(array);
    }
    public static void selection(int[] array) {
        for (int i = 0; i < array.length - 1; i++) {
//                i ä»£è¡¨æ¯è½®é€‰æ‹©æœ€å°å…ƒç´ è¦äº¤æ¢åˆ°çš„ç›®æ ‡ç´¢å¼•
            int s =i; // ä»£è¡¨æœ€å°å…ƒç´ çš„ç´¢å¼•å€¼
            for (int j = s+1; j < array.length; j++) {   // æ­¤å¾ªç¯ä¸ºäº†æ‰¾å‡ºæœ€å°çš„é‚£ä¸ªç´¢å¼•ï¼Œæ‰¾å‡ºåæ”¾åˆ°æœ€å°çš„ç´¢å¼•ä½ç½®ï¼Œ
                if (array[s] > array[j]) { // j å…ƒç´ æ¯” s å…ƒç´ è¿˜è¦å°, æ›´æ–° s
                    s = j;   //  æœ€å°å€¼æ”¾åˆ°sçš„ç´¢å¼•ä¸Š
                }
            }
            if (s!=i) { //  å°†å½“å‰æœ€å°æ•°æ®å€¼ä¸æ­¤æ¬¡å¾ªç¯çš„å¼€å§‹ä½ç½®æ•°æ®åšäº¤æ¢ã€‚
                swap(array,s,i);
            }
            System.out.println(Arrays.toString(array));
        }
    }
    public static void swap(int[] array, int i, int j) {
//        i æœ€å°å…ƒç´ çš„ç´¢å¼•å€¼ j
        int t = array[i];
        array[i] = array[j];
        array[j] = t;
    }
}
// è¾“å‡ºç»“æœä¸º
[1, 3, 7, 2, 5, 9, 8, 4]
[1, 2, 7, 3, 5, 9, 8, 4]
[1, 2, 3, 7, 5, 9, 8, 4]
[1, 2, 3, 4, 5, 9, 8, 7]
[1, 2, 3, 4, 5, 9, 8, 7]
[1, 2, 3, 4, 5, 7, 8, 9]
[1, 2, 3, 4, 5, 7, 8, 9]
```





------


## é›†åˆéƒ¨åˆ†
###  7.ArrayList

**è¦æ±‚**

* æŒæ¡ ArrayList æ‰©å®¹è§„åˆ™

æ— å‚ArrayList ï¼Œåˆå§‹å€¼æ˜¯ç©ºï¼Œå³ä¸º0ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};

public ArrayList() {
        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
    }
```

æœ‰å‚ArrayList ,åˆå§‹å€¼æ˜¯æ•´æ•°ï¼Œåˆå§‹å€¼æ˜¯é‚£ä¸ªæ•´æ•°å‚æ•°çš„å¤§å°ï¼Œé»˜è®¤æ˜¯10ã€‚

```java
private static final Object[] EMPTY_ELEMENTDATA = {};

public ArrayList(int initialCapacity) {
        if (initialCapacity > 0) {
            this.elementData = new Object[initialCapacity];
        } else if (initialCapacity == 0) {
            this.elementData = EMPTY_ELEMENTDATA;
        } else {
            throw new IllegalArgumentException("Illegal Capacity: "+
                                               initialCapacity);
        }
    }
```

æœ‰å‚ArrayList ï¼Œåˆå§‹å€¼æ˜¯é›†åˆï¼Œåˆå§‹å€¼æ˜¯é›†åˆå…ƒç´ ä¸ªæ•°ï¼š

```java


public ArrayList(Collection<? extends E> c) {
        Object[] a = c.toArray();
        if ((size = a.length) != 0) {
            if (c.getClass() == ArrayList.class) {
                elementData = a;
            } else {
                elementData = Arrays.copyOf(a, size, Object[].class);
            }
        } else {
            // replace with empty array.
            elementData = EMPTY_ELEMENTDATA;
        }
    }
```

**æ‰©å®¹**ï¼š

 åœ¨ Java ä¸­ï¼ŒArrayList å†…éƒ¨é‡‡ç”¨ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨å…ƒç´ ï¼Œå½“æ•°ç»„çš„é•¿åº¦ä¸è¶³ä»¥å®¹çº³æ–°çš„å…ƒç´ æ—¶ï¼Œéœ€è¦è¿›è¡Œæ‰©å®¹æ“ä½œã€‚ArrayList çš„æ‰©å®¹æœºåˆ¶æ˜¯æ¯æ¬¡æ‰©å®¹å®¹é‡å˜ä¸ºåŸæ¥çš„ 1.5 å€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡æ‰©å®¹åï¼Œæ•°ç»„çš„é•¿åº¦ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€ã€‚ 

**1.5 å€çš„æ¥ç”±ï¼š**

åŸæ•°ç»„çš„å…ƒç´ ä¸ªæ•°å€¼ï¼Œå³ç§»ä¸€ä½ï¼Œåœ¨äºŒè¿›åˆ¶ä¸­ï¼Œå³ç§»ä¸€ä½ç›¸å½“äºé™¤ä»¥2ï¼Œå¾—å‡ºæ•°å­—åä¸åŸæ•°ç»„å…ƒç´ ä¸ªæ•°ç›¸åŠ ï¼Œå¾—å‡ºç»“æœä¸ºæ–°æ•°ç»„å¤§å°ï¼Œeg:åŸæ•°ç»„å¤§å°æ˜¯15,15>>1ï¼Œå¾—7ï¼Œ15+7=22ï¼Œå³æ–°æ•°ç»„å¤§å°ä¸º22ã€‚

ä»£ç ï¼š

```java
private void ensureCapacityInternal(int minCapacity) {
    // å¦‚æœ ArrayList çš„å®¹é‡ä¸è¶³ä»¥å®¹çº³æ–°çš„å…ƒç´ 
    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
        // å¦‚æœ ArrayList å†…éƒ¨æ•°ç»„è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–ä¸€ä¸ªé»˜è®¤é•¿åº¦ä¸º 10 çš„æ•°ç»„
        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);
    }
    // å¦‚æœéœ€è¦æ‰©å®¹
    if (minCapacity - elementData.length > 0)
        grow(minCapacity);
}

/**
 * æ‰©å®¹æ–¹æ³•
 */
private void grow(int minCapacity) {
    // æ‰©å®¹å‰çš„æ•°ç»„é•¿åº¦
    int oldCapacity = elementData.length;
    // æ‰©å®¹åçš„æ•°ç»„é•¿åº¦ï¼Œæ¯æ¬¡æ‰©å®¹ä¸ºåŸæ¥çš„ 1.5 å€
    int newCapacity = oldCapacity + (oldCapacity >> 1);
    // å¦‚æœæ‰©å®¹åçš„æ•°ç»„é•¿åº¦ä¾ç„¶æ— æ³•å®¹çº³å…ƒç´ ï¼Œåˆ™å°†æ•°ç»„é•¿åº¦è®¾ä¸º minCapacity(*è¦æ·»åŠ å…ƒç´ çš„ä¸ªæ•°ï¼Œå³æ–°æ•°ç»„æ‰©å®¹åä¹Ÿæ— æ³•æ»¡è¶³å¤§å°ï¼Œç›´æ¥å»ºè¦ä¼ å…¥å…ƒç´ ä¸ªæ•°å¤§å°çš„æ•°ç»„*)
    if (newCapacity - minCapacity < 0)
        newCapacity = minCapacity;
    // å°†åŸæ¥çš„æ•°ç»„æ‹·è´åˆ°æ–°çš„æ•°ç»„ä¸­
    elementData = Arrays.copyOf(elementData, newCapacity);
}

```

**æ‰©å®¹è§„åˆ™æ€»ç»“**

1. ArrayList() ä¼šä½¿ç”¨é•¿åº¦ä¸ºé›¶çš„æ•°ç»„
2. ArrayList(int initialCapacity) ä¼šä½¿ç”¨æŒ‡å®šå®¹é‡çš„æ•°ç»„
3. public ArrayList(Collection<? extends E> c) ä¼šä½¿ç”¨ c çš„å¤§å°ä½œä¸ºæ•°ç»„å®¹é‡
4. add(Object o) é¦–æ¬¡æ‰©å®¹ä¸º 10ï¼Œå†æ¬¡æ‰©å®¹ä¸ºä¸Šæ¬¡å®¹é‡çš„ 1.5 å€
5. addAll(Collection c) æ²¡æœ‰å…ƒç´ æ—¶ï¼Œæ‰©å®¹ä¸º Math.max(10, å®é™…å…ƒç´ ä¸ªæ•°)å–ä¸¤è€…ä¹‹é—´æœ€å¤§å€¼ï¼Œæœ‰å…ƒç´ æ—¶ä¸º Math.max(åŸå®¹é‡ 1.5 å€, å®é™…å…ƒç´ ä¸ªæ•°)

------

### 8. Iterator

**è¦æ±‚**

* æŒæ¡ä»€ä¹ˆæ˜¯ Fail-Fastã€ä»€ä¹ˆæ˜¯ Fail-Safe

Fail-Fast ä¸ Fail-Safe

* ArrayList æ˜¯ fail-fast çš„å…¸å‹ä»£è¡¨ï¼Œéå†çš„åŒæ—¶ä¸èƒ½ä¿®æ”¹ï¼Œå°½å¿«å¤±è´¥

* CopyOnWriteArrayList æ˜¯ fail-safe çš„å…¸å‹ä»£è¡¨ï¼Œéå†çš„åŒæ—¶å¯ä»¥ä¿®æ”¹ï¼ŒåŸç†æ˜¯è¯»å†™åˆ†ç¦»ï¼Œä¿®æ”¹ånewå»ºä¸ªé›†åˆï¼Œæ‰€ä»¥å½“æ—¶éå†çš„é›†åˆå’Œä¿®æ”¹åçš„é›†åˆä¸æ˜¯ä¸€ä¸ªé›†åˆã€‚

**æç¤º**

>[ä»£ç ç¤ºä¾‹ğŸ‘ˆ](https://github.com/Fengleitown/BLOG-code/tree/main/src/main/java/day01/list)ä¸­FailFastVsFailSafe


### 9.LinkedList

**è¦æ±‚**

* èƒ½å¤Ÿè¯´æ¸…æ¥š LinkedList å¯¹æ¯” ArrayList çš„åŒºåˆ«ï¼Œå¹¶é‡è§†çº æ­£éƒ¨åˆ†é”™è¯¯çš„è®¤çŸ¥

**ArrayListä¸LinkedListåŒºåˆ«**

- ArrayList

  - åŸºäºæ•°ç»„ï¼Œéœ€è¦è¿ç»­å†…å­˜
  - éšæœºè®¿é—®å¿«ï¼ˆæŒ‡æ ¹æ®ä¸‹æ ‡è®¿é—®ï¼‰
  - å°¾éƒ¨æ’å…¥ã€åˆ é™¤æ€§èƒ½å¯ä»¥ï¼Œå…¶ä»–éƒ¨åˆ†æ’å…¥ã€åˆ é™¤éƒ½ä¼šç§»åŠ¨æ•°æ®ï¼Œå› æ­¤æ€§èƒ½ä¼šä½
  - å¯ä»¥åˆ©ç”¨cpuç¼“å­˜ï¼Œå±€éƒ¨æ€§èƒ½åŸç†
    - è§£é‡Š:
      -  1.cpuç¼“å­˜çš„å¼•å…¥ä½œç”¨ï¼šæ¯”å¦‚cpuåšè¿ç®—æ“ä½œï¼Œéœ€è¦ä»å†…å­˜ä¸­è¯»å–æ•°å­—ç„¶åæ”¾åˆ°å¯„å­˜å™¨ä¸­ï¼Œç®—å‡ºç»“æœåï¼Œå†å°†æ•°å€¼æ”¾åˆ°å†…å­˜ä¸­ï¼Œå†…å­˜çš„è¯»å†™æ•ˆç‡æ²¡é‚£ä¹ˆé«˜ä¼šæœ‰å‡ ç™¾çº³ç§’ï¼Œè¿™æ ·å¦‚æœåç»­ä¸­æ¯æ¬¡æ“ä½œéƒ½åˆ©ç”¨è¿™ä¸ªæ•°å­—ï¼Œæ•ˆç‡å¤ªä½ï¼Œè¿™æ ·å°±å¼•å…¥äº†cpuç¼“å­˜ï¼Œç±»ä¼¼ç¼“å­˜ä¸­é—´ä»¶ï¼Œæå‡æ•ˆç‡ã€‚
      - 2.å±€éƒ¨æ€§åŸç†ï¼Œå°†æ•°æ®è¯»å–åæ”¾åˆ°cpuç¼“å­˜ä¸­ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠç›¸é‚»æ•°æ®ä¹Ÿæ”¾åˆ°cpuç¼“å­˜ä¸­ï¼Œè¿™æ ·çš„æ“ä½œå¯¹æ•°ç»„å¾ˆæœ‰åˆ©ï¼Œä½†é“¾è¡¨å°±ä¸è¡Œï¼Œé“¾è¡¨è¯»å–åˆ°ç›¸é‚»å…ƒç´ åï¼Œå¯èƒ½æ˜¯æ²¡ç”¨çš„ï¼Œå› ä¸ºä»–çš„å†…å­˜åœ°å€æ˜¯éšæœºçš„,è€Œä¸”cpuç¼“å­˜ç©ºé—´å¤§å°ä¹Ÿæœ‰é™ï¼Œç­‰ä¸‹æ¬¡æ ¹æ®å±€éƒ¨æ€§åŸç†å°†ç›¸å…³æ•°æ®æ”¾åˆ°cpuç¼“å­˜ä¸­æ—¶ï¼Œå¯èƒ½ä¼šå°†ä¹‹å‰çš„æ•°æ®è¦†ç›–æ‰ã€‚


![](/assets/img/ext-img/cpuç¼“å­˜.jpg)

- LinkedList

  - åŸºäºåŒå‘é“¾è¡¨ï¼Œæ— éœ€è¿ç»­å†…å­˜
  - éšæœºè®¿é—®æ…¢ï¼ˆè¦æ²¿ç€é“¾è¡¨éå†ï¼‰
  - å¤´å°¾æ’å…¥åˆ é™¤æ€§èƒ½é«˜ï¼ˆåœ¨é“¾è¡¨ä¸­é—´æ’å…¥æ€§èƒ½ä¸é«˜ï¼Œå› ä¸ºè¦æŸ¥æ‰¾æ’å…¥ä½ç½®çš„å…ƒç´ ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹ä¼šå¾ˆæ…¢ï¼Œæ‰¾åˆ°ä¹‹åæ’å…¥æ€§èƒ½ä¼šå¾ˆé«˜ï¼‰
  - å ç”¨å†…å­˜å¤šï¼ˆæœ‰å¾ˆå¤šNodeèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æœ‰ä¸‰ä¸ªå±æ€§ï¼Œåˆ†åˆ«æ˜¯ ä¸Šä¸ªå…ƒç´ ä¸‹æ ‡ã€å…ƒç´ ã€ä¸‹ä¸ªå…ƒç´ ä¸‹æ ‡ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¤´å°¾ç»“ç‚¹ç­‰ï¼Œæ‰€ä»¥å ç”¨å†…å­˜è¾ƒå¤§ã€‚ï¼‰
  
  **æ€»ç»“**ï¼šç»¼åˆæ¥çœ‹ï¼Œå¹³å‡ä½¿ç”¨ArrayListæ•ˆç‡é«˜ï¼Œå¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯ç”¨ArrayListã€‚é™¤éæ˜¯å¤´æ’ï¼Œåˆ™ç”¨LinkedListã€‚

### 10. HashMap

é¢è¯•é¢˜ï¼š1.åº•å±‚æ•°æ®ç»“æ„ï¼Œ1.7å’Œ1.8æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

* 1.7 æ•°ç»„ + é“¾è¡¨
* 1.8 æ•°ç»„ + ï¼ˆé“¾è¡¨ | çº¢é»‘æ ‘ï¼‰

2.ä¸ºä½•è¦ç”¨çº¢é»‘æ ‘ï¼Œä¸ºä½•ä¸€ä¸Šæ¥ä¸æ ‘åŒ–ï¼Œæ ‘åŒ–é˜ˆå€¼ä¸ºä½•æ˜¯8ï¼Œä½•æ—¶ä¼šæ ‘åŒ–ï¼Œä½•æ—¶ä¼šé€€åŒ–ä¸ºé“¾è¡¨ï¼Ÿ

- ä¸ºä»€ä¹ˆè¦ç”¨çº¢é»‘æ ‘ ğŸŒ´ ï¼Ÿ
  - å› ä¸º1.7é‡Œé¢å¦‚æœé“¾è¡¨å¤ªé•¿äº†ï¼Œå®ƒå…¶å®æ˜¯ä¼šå½±å“æˆ‘ä»¬æ•´ä¸ªhashMapçš„æ€§èƒ½ï¼Œé‚£1.8ä»¥åå¼•å…¥äº†è¿™ä¸ªçº¢é»‘æ ‘ä¹‹åï¼Œåœ¨é“¾è¡¨æ¯”è¾ƒé•¿çš„æ—¶å€™ï¼Œä¼šæå‡æ€§èƒ½ã€‚
    è¿™æ˜¯è¿™ä¸ªé—®é¢˜å•Šã€‚
  
- ä½•æ—¶ä¼šæ ‘åŒ– ğŸŒ´ ï¼Ÿ
  
  - è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼Œç¬¬ä¸€ä¸ªé“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼8ï¼Œç¬¬äºŒä¸ªå°±æ˜¯æ•´ä¸ªæ•°å­—çš„é•¿åº¦è¦å¤§äºç­‰äº64ï¼Œè¿™ä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³äº†ï¼Œåˆ—è¡¨å°±å¯ä»¥å˜æˆæ ‘äº†ã€‚
  
- ä¸ºä»€ä¹ˆä¸æ˜¯ä¸€ä¸Šæ¥å°±è¿›è¡Œæ ‘åŒ– ğŸŒ´ï¼Ÿ 
  
  - è¿™ä¸ªå‘¢ï¼Œå¤§å®¶è¦æƒ³ä¸€æƒ³ï¼Œå¦‚æœå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘è¿™ä¸ªé“¾è¡¨ä¸­åªæœ‰ä¸€ä¸ªä¸¤ä¸ªä¸‰ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œé‚£å®ƒæ¯”è¾ƒçš„æ¬¡æ•°æœ€å¤šä¹Ÿå°±æ˜¯ä¸‰æ¬¡ã€‚é‚£å¦‚æœè´¹äº†ä¸€å¤§å †åŠ²ï¼ŒæŠŠè¿™ä¸ªé“¾è¡¨å˜æˆäº†ä¸€ä¸ªçŸ­çš„é“¾è¡¨ï¼Œå˜æˆäº†æ ‘ä»¥åï¼Œå®ƒçš„æ€§èƒ½å°±èƒ½å¤Ÿæ¯”æˆ‘ä»¬è¿™ç§çŸ­é“¾è¡¨æ€§èƒ½æ›´é«˜å—ï¼Ÿæ˜¾ç„¶ä¸ä¼šå¯¹å§ï¼Œå“ï¼Œæˆ‘ä»¬é“¾è¡¨çŸ­çš„æƒ…å†µä¸‹ï¼Œå…¶å®æ€§èƒ½æ˜¯æ¯”çº¢é»‘æ•°è¦å¥½çš„ï¼Œåªæœ‰æ˜¯é“¾è¡¨æ¯”è¾ƒé•¿çš„æƒ…å†µä¸‹ï¼Œå®ƒçš„æ€§èƒ½æ‰æ˜¯è¿œè¿œä¸å¦‚çº¢é»‘æ ‘ï¼Œæ‰€ä»¥å¦‚æœé“¾è¡¨çŸ­æ²¡æœ‰å¿…è¦è¿›è¡Œä¹¦æ³•ã€‚è€Œä¸”å˜æˆæ ‘ä»¥åï¼Œå®ƒå ç”¨çš„å†…å­˜ä¹Ÿå¤šå•Šï¼Œå› ä¸ºé“¾è¡¨å®ƒçš„ä¸€ä¸ªæ•°æ®ç»“æ„æ˜¯nodeï¼Œè€Œçº¢é»‘æ ‘å‘¢ï¼Œå®ƒçš„åº•å±‚æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªtreeNode,treeNodeé‡Œé¢çš„æˆå‘˜å˜é‡è¦æ¯”é“¾è¡¨å¤šå¾ˆå¤šï¼Œå› æ­¤å‘¢ï¼Œå¯¹å†…å­˜çš„å ç”¨ä¹Ÿæ›´å¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚éå¿…è¦ä¸è¦è½¬åŒ–æˆçº¢é»‘æ ‘ã€‚
  
- ä¸ºä»€ä¹ˆæ ‘åŒ–é˜ˆå€¼é€‰æ‹©äº†8ï¼Œè€Œä¸æ˜¯é€‰ä¸€ä¸ªæ›´å°çš„æ•°ï¼Œè®©å®ƒåœ¨é“¾è¡¨æ›´çŸ­çš„ä¸€ç‚¹çš„æ—¶å€™å°±å˜æˆæ ‘ ğŸŒ´ å‘¢ï¼Ÿ
  å…¶å®æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„é“¾è¡¨é•¿åº¦ç»ä¸å¯èƒ½è¶…è¿‡8
  
- ä½•æ—¶ä¼šé€€åŒ–ä¸ºé“¾è¡¨ï¼Ÿ
  
  - æ‰©å®¹æ—¶æ ‘ä¼šæ‹†åˆ†ï¼Œå½“æ‹†åˆ†åå‰©ä½™å…ƒç´ ä¸ªæ•°<=6æ—¶ï¼Œä¼šé€€åŒ–æˆé“¾è¡¨ï¼ˆå…ƒç´ æ˜¯7æ—¶è¿˜æ˜¯çº¢é»‘æ ‘ç»“æ„ï¼‰ã€‚
  
- ä¸¾ä¸ªä¾‹å­ ğŸŒ° è¯æ˜ä¸€ä¸‹å•Šã€‚

  - >[ä»£ç ç¤ºä¾‹ğŸ‘ˆ](https://github.com/Fengleitown/BLOG-code/tree/main/src/main/java/day01/map)ä¸­HashMapDistribution.java

    ç»“æœä¸ºï¼š ğŸ‘‡ 


```
class java.util.HashMap
æ€»çš„æ¡¶ä¸ªæ•°[524288]
0ä¸ªå…ƒç´ çš„æ¡¶ä¸ªæ•°[334855]
1ä¸ªå…ƒç´ çš„æ¡¶ä¸ªæ•°[150323]
2ä¸ªå…ƒç´ çš„æ¡¶ä¸ªæ•°[33401]
3ä¸ªå…ƒç´ çš„æ¡¶ä¸ªæ•°[5090]
4ä¸ªå…ƒç´ çš„æ¡¶ä¸ªæ•°[555]
5ä¸ªå…ƒç´ çš„æ¡¶ä¸ªæ•°[62]
6ä¸ªå…ƒç´ çš„æ¡¶ä¸ªæ•°[2]
```

å¯è§é“¾è¡¨é•¿åº¦ä¸º6çš„æ—¶å€™éƒ½æ¯”è¾ƒå°‘ï¼Œåªæœ‰ä¸¤ä¸ªï¼Œæ‰€ä»¥8å°±å¤Ÿç”¨äº†ï¼Œçº¢é»‘æ ‘ä¹Ÿæ˜¯ä¸æ­£å¸¸çš„ä¸€ç§æƒ…å†µï¼Œä¸»è¦ç›®çš„ä¸ºäº†é˜²æ­¢ DoS æ”»å‡»ã€‚ ğŸ’¯ 

------



**è¦æ±‚**

* æŒæ¡ HashMap çš„åŸºæœ¬æ•°æ®ç»“æ„
* æŒæ¡æ ‘åŒ–
* ç†è§£ç´¢å¼•è®¡ç®—æ–¹æ³•ã€äºŒæ¬¡ hash çš„æ„ä¹‰ã€å®¹é‡å¯¹ç´¢å¼•è®¡ç®—çš„å½±å“
* æŒæ¡ put æµç¨‹ã€æ‰©å®¹ã€æ‰©å®¹å› å­
* ç†è§£å¹¶å‘ä½¿ç”¨ HashMap å¯èƒ½å¯¼è‡´çš„é—®é¢˜
* ç†è§£ key çš„è®¾è®¡

#### 1ï¼‰åŸºæœ¬æ•°æ®ç»“æ„

* 1.7 æ•°ç»„ + é“¾è¡¨
* 1.8 æ•°ç»„ + ï¼ˆé“¾è¡¨ | çº¢é»‘æ ‘ï¼‰

#### 2ï¼‰æ ‘åŒ–ä¸é€€åŒ–

**æ ‘åŒ–æ„ä¹‰**

* çº¢é»‘æ ‘ç”¨æ¥é¿å… DoS æ”»å‡»ï¼Œé˜²æ­¢é“¾è¡¨è¶…é•¿æ—¶æ€§èƒ½ä¸‹é™ï¼Œæ ‘åŒ–åº”å½“æ˜¯å¶ç„¶æƒ…å†µï¼Œæ˜¯ä¿åº•ç­–ç•¥
  - hash è¡¨çš„æŸ¥æ‰¾ï¼Œæ›´æ–°çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œè€Œçº¢é»‘æ ‘çš„æŸ¥æ‰¾ï¼Œæ›´æ–°çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(log_2â¡n )$ï¼ŒTreeNode å ç”¨ç©ºé—´ä¹Ÿæ¯”æ™®é€š Node çš„å¤§ï¼Œå¦‚éå¿…è¦ï¼Œå°½é‡è¿˜æ˜¯ä½¿ç”¨é“¾è¡¨
  - hash å€¼å¦‚æœè¶³å¤Ÿéšæœºï¼Œåˆ™åœ¨ hash è¡¨å†…æŒ‰æ³Šæ¾åˆ†å¸ƒï¼Œåœ¨è´Ÿè½½å› å­ 0.75 çš„æƒ…å†µä¸‹ï¼Œé•¿åº¦è¶…è¿‡ 8 çš„é“¾è¡¨å‡ºç°æ¦‚ç‡æ˜¯ 0.00000006ï¼Œæ ‘åŒ–é˜ˆå€¼é€‰æ‹© 8 å°±æ˜¯ä¸ºäº†è®©æ ‘åŒ–å‡ ç‡è¶³å¤Ÿå°

**æ ‘åŒ–è§„åˆ™**

- æ ‘åŒ–ä¸¤ä¸ªæ¡ä»¶ï¼š
  - â‘  é“¾è¡¨é•¿åº¦è¶…è¿‡æ ‘åŒ–é˜ˆå€¼ 8 
  - â‘¡ æ•°ç»„å®¹é‡>=64

 ğŸ’¡ è¯´æ˜ï¼š**å½“é“¾è¡¨é•¿åº¦è¶…è¿‡æ ‘åŒ–é˜ˆå€¼ 8 æ—¶ï¼Œå…ˆå°è¯•æ‰©å®¹æ¥å‡å°‘é“¾è¡¨é•¿åº¦ï¼Œå¦‚æœæ•°ç»„å®¹é‡å·²ç» >=64ï¼Œæ‰ä¼šè¿›è¡Œæ ‘åŒ–**

**é€€åŒ–è§„åˆ™**

* æƒ…å†µ1ï¼šåœ¨æ‰©å®¹æ—¶å¦‚æœæ‹†åˆ†æ ‘æ—¶ï¼Œæ ‘å…ƒç´ ä¸ªæ•° <= 6 åˆ™ä¼šé€€åŒ–é“¾è¡¨
* æƒ…å†µ2ï¼šremove æ ‘èŠ‚ç‚¹æ—¶ï¼Œè‹¥ rootã€root.left(å·¦å­©å­)ã€root.right(å³å­©å­)ã€root.left.left(å·¦å­™å­) æœ‰ä¸€ä¸ªä¸º null ï¼Œä¹Ÿä¼šé€€åŒ–ä¸ºé“¾è¡¨ï¼ˆç§»é™¤ä¹‹å‰ä¸Šé¢å‡ ä¸ªå…ƒç´ éƒ½å­˜åœ¨ï¼Œä¸ä¼šé€€åŒ–æˆé“¾è¡¨ã€‚ç§»é™¤ä¹‹å‰ä¸Šé¢å‡ ä¸ªå…ƒç´ æœ‰å…¶ä¸­ä¸€ä¸ªä¸å­˜åœ¨ï¼Œåˆ™ä¼šé€€åŒ–æˆé“¾è¡¨ï¼‰

#### 3ï¼‰ç´¢å¼•è®¡ç®—

*é¢è¯•é¢˜ï¼šç´¢å¼•å¦‚ä½•è®¡ç®—çš„ï¼Ÿhashcodeéƒ½æœ‰äº†ï¼Œä¸ºä½•è¿˜è¦æä¾›hash()æ–¹æ³•ï¼Ÿæ•°ç»„å®¹é‡ä¸ºä½•æ˜¯2çš„næ¬¡å¹‚ï¼Ÿ*

**ç´¢å¼•è®¡ç®—æ–¹æ³•**

* â‘ è®¡ç®—`å¯¹è±¡` ğŸ˜ çš„ hashCode()ï¼Œå¾—åˆ°åŸå§‹hashå€¼ã€‚
* â‘¡è°ƒç”¨ `HashMap` çš„ hash() æ–¹æ³•è¿›è¡ŒäºŒæ¬¡å“ˆå¸Œã€‚
  * äºŒæ¬¡ hash() æ˜¯ä¸ºäº†ç»¼åˆé«˜ä½æ•°æ®ï¼Œè®©å“ˆå¸Œåˆ†å¸ƒæ›´ä¸ºå‡åŒ€ã€‚ç¬¬ä¸€æ¬¡hash(): é€šè¿‡å¯¹é”® ğŸ”‘ çš„hashCode()æ–¹æ³•çš„è¿”å›å€¼è¿›è¡Œè¿ç®—å¾—åˆ°çš„ã€‚  ç”±äºå¯èƒ½å­˜åœ¨å“ˆå¸Œå†²çªï¼Œå³ä¸åŒçš„é”®å€¼å¯¹å¯èƒ½äº§ç”Ÿç›¸åŒçš„å“ˆå¸Œç ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨äºŒæ¬¡å“ˆå¸Œï¼ˆåˆç§°ä¸ºå†å“ˆå¸Œï¼‰æ¥è§£å†³å“ˆå¸Œå†²çªã€‚ 
* â‘¢æœ€å `äºŒæ¬¡å“ˆå¸Œå€¼ & (capacity â€“ 1)ï¼Œå“ˆå¸Œå€¼æŒ‰ä½ä¸å®¹é‡-1è¿ç®— `å¾—åˆ°ç´¢å¼•ï¼Œæˆ–`äºŒæ¬¡å“ˆå¸Œå€¼å¯¹mapå®¹é‡å–æ¨¡`è¿ç®—ï¼Œå¾—åˆ°é“¾è¡¨çš„ç´¢å¼•ã€‚

**æ•°ç»„å®¹é‡ä¸ºä½•æ˜¯ 2 çš„ n æ¬¡å¹‚**

1. è®¡ç®—ç´¢å¼•æ—¶æ•ˆç‡æ›´é«˜ï¼šå¦‚æœæ˜¯ 2 çš„ n æ¬¡å¹‚å¯ä»¥ä½¿ç”¨ä½ä¸è¿ç®—ä»£æ›¿å–æ¨¡
2. æ‰©å®¹æ—¶é‡æ–°è®¡ç®—ç´¢å¼•æ•ˆç‡æ›´é«˜ï¼š hash & oldCap == 0 çš„å…ƒç´ ç•™åœ¨åŸæ¥ä½ç½® ï¼Œå¦åˆ™æ–°ä½ç½® = æ—§ä½ç½® + oldCap
   - è§£é‡Šï¼šhashæŒ‰ä½ä¸è¿ç®—æ—§capacity == 0çš„å…ƒç´ æ‰©å®¹åç•™åœ¨åŸæ¥ä½ç½®ï¼Œä¸ç­‰äº0æ—¶ï¼Œæ–°ä½ç½® = æ—§ä½ç½®ï¼ˆç´¢å¼•ä¸‹æ ‡ï¼‰+ æ—§ capacity ã€‚
    ![](/assets/img/ext-img/mapæ‰©å®¹åçš„ä½ç½®.jpg)

 âš ï¸ æ³¨æ„ï¼š

* äºŒæ¬¡ hash æ˜¯ä¸ºäº†é…åˆ **å®¹é‡æ˜¯ 2 çš„ n æ¬¡å¹‚** è¿™ä¸€è®¾è®¡å‰æï¼Œå¦‚æœ hash è¡¨çš„å®¹é‡ä¸æ˜¯ 2 çš„ n æ¬¡å¹‚ï¼Œåˆ™ä¸å¿…äºŒæ¬¡ hash
* **å®¹é‡æ˜¯ 2 çš„ n æ¬¡å¹‚** è¿™ä¸€è®¾è®¡è®¡ç®—ç´¢å¼•æ•ˆç‡æ›´å¥½ï¼Œä½† hash çš„åˆ†æ•£æ€§å°±ä¸å¥½ï¼Œéœ€è¦äºŒæ¬¡ hash æ¥ä½œä¸ºè¡¥å¿ï¼Œæ²¡æœ‰é‡‡ç”¨è¿™ä¸€è®¾è®¡çš„å…¸å‹ä¾‹å­æ˜¯ Hashtable

#### 4ï¼‰put ä¸æ‰©å®¹

*é¢è¯•é¢˜ï¼šä»‹ç»ä¸€ä¸ªputæ–¹æ³•çš„æµç¨‹ï¼Œ1.7ä¸1.8æœ‰ä½•ä¸åŒï¼Ÿ*

**put æµç¨‹**

1. HashMap æ˜¯æ‡’æƒ°åˆ›å»ºæ•°ç»„çš„ï¼Œé¦–æ¬¡ä½¿ç”¨æ‰åˆ›å»ºæ•°ç»„

2. è®¡ç®—ç´¢å¼•ï¼ˆæ¡¶ä¸‹æ ‡ï¼‰

3. å¦‚æœæ¡¶ä¸‹æ ‡è¿˜æ²¡äººå ç”¨ï¼Œåˆ›å»º Node å ä½è¿”å›

4. å¦‚æœæ¡¶ä¸‹æ ‡å·²ç»æœ‰äººå ç”¨

   1. å·²ç»æ˜¯ TreeNode èµ°çº¢é»‘æ ‘çš„æ·»åŠ æˆ–æ›´æ–°é€»è¾‘
   2. æ˜¯æ™®é€š Nodeï¼Œèµ°é“¾è¡¨çš„æ·»åŠ æˆ–æ›´æ–°é€»è¾‘ï¼Œå¦‚æœé“¾è¡¨é•¿åº¦è¶…è¿‡æ ‘åŒ–é˜ˆå€¼ï¼Œèµ°æ ‘åŒ–é€»è¾‘

5. è¿”å›å‰æ£€æŸ¥å®¹é‡æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼Œä¸€æ—¦è¶…è¿‡è¿›è¡Œæ‰©å®¹

   - æ‰©å®¹è¿‡ç¨‹

   â€‹    â‘ å…ˆæŠŠå…ƒç´ åŠ è¿›å»åŸå§‹map

   â€‹	â‘¡ç„¶åéœ€è¦æ‰©å®¹çš„è¯ï¼Œåˆ›å»ºæ–°æ•°ç»„æ‰©å®¹ã€‚

   â€‹	â‘¢ä¸€ä¸ªé“¾è¡¨ä¸€ä¸ªé“¾è¡¨æŠŠå…ƒç´ éƒ½è¿ç§»åˆ°æ–°ä¹¦ç»„ä¸­

**1.7 ä¸ 1.8 çš„åŒºåˆ«**

1. é“¾è¡¨æ’å…¥èŠ‚ç‚¹æ—¶ï¼Œ1.7 æ˜¯å¤´æ’æ³•ï¼Œ1.8 æ˜¯å°¾æ’æ³•
2. 1.7 æ˜¯å¤§äºç­‰äºé˜ˆå€¼ä¸”æ²¡æœ‰ç©ºä½æ—¶æ‰æ‰©å®¹ï¼Œè€Œ 1.8 æ˜¯å¤§äºé˜ˆå€¼å°±æ‰©å®¹
3. 1.8 åœ¨æ‰©å®¹è®¡ç®— Node ç´¢å¼•æ—¶ï¼Œä¼šä¼˜åŒ–

**æ‰©å®¹ï¼ˆåŠ è½½ï¼‰å› å­ä¸ºä½•é»˜è®¤æ˜¯ 0.75f**ï¼Ÿï¼ˆåŠ è½½å› å­å°±æ˜¯3/4ï¼Œ16X3/4=13,å¤§äºè¿™ä¸ªæ•°å°±æ‰©å®¹ï¼‰

1. åœ¨ç©ºé—´å ç”¨ä¸æŸ¥è¯¢æ—¶é—´ä¹‹é—´å–å¾—è¾ƒå¥½çš„æƒè¡¡
2. å¤§äºè¿™ä¸ªå€¼ï¼Œç©ºé—´èŠ‚çœäº†ï¼Œä½†é“¾è¡¨å°±ä¼šæ¯”è¾ƒé•¿å½±å“æ€§èƒ½
3. å°äºè¿™ä¸ªå€¼ï¼Œå†²çªå‡å°‘äº†ï¼Œä½†æ‰©å®¹å°±ä¼šæ›´é¢‘ç¹ï¼Œç©ºé—´å ç”¨ä¹Ÿæ›´å¤š

#### 5ï¼‰å¹¶å‘é—®é¢˜

*é¢è¯•é¢˜ï¼šå¤šçº¿ç¨‹ä¸‹æ“ä½œhashMapä¼šæœ‰å•¥é—®é¢˜ï¼Ÿ*

**æ‰©å®¹æ­»é“¾ï¼ˆ1.7 ä¼šå­˜åœ¨ï¼‰**



**æ•°æ®é”™ä¹±ï¼ˆ1.7ï¼Œ1.8 éƒ½ä¼šå­˜åœ¨ï¼‰**

å­˜åœ¨çº¿ç¨‹ä¹‹é—´ä¼šè¦†ç›–æ•°æ®çš„é—®é¢˜ã€‚

> [ä»£ç ç¤ºä¾‹ğŸ‘ˆ](https://github.com/Fengleitown/BLOG-code/tree/main/src/main/java/day01/map)ä¸­	HashMapMissData.java

#### 6ï¼‰key çš„è®¾è®¡

é¢è¯•é¢˜ï¼škeyèƒ½å¦ä¸ºnull,ä½œä¸ºkeyçš„å¯¹è±¡æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ

- hashmapçš„keyå¯ä»¥ä¸ºNull,ä½†å…¶ä»–mapå®ç°åˆ™ä¸ç„¶ã€‚
- ä½œä¸º key çš„å¯¹è±¡ï¼Œå¿…é¡»å®ç° hashCode ï¼ˆä¸ºäº†keyåœ¨æ•´ä¸ªhashMapä¸­æœ‰æ›´å¥½çš„åˆ†å¸ƒæ€§ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ï¼‰å’Œ equalsï¼ˆä¸‡ä¸€ä¸¤ä¸ªkeyè®¡ç®—å‡ºæ¥çš„ç»“æœä¸€æ ·ï¼Œè¦æ¯”è¾ƒçœ‹ä»–ä»¬æ˜¯ä¸æ˜¯ç›¸åŒçš„å¯¹è±¡ï¼‰ï¼Œå¹¶ä¸” key çš„å†…å®¹ä¸èƒ½ä¿®æ”¹ï¼ˆä¸å¯å˜ï¼‰> [ä»£ç ç¤ºä¾‹ğŸ‘ˆ](https://github.com/Fengleitown/BLOG-code/tree/main/src/main/java/day01/map)ä¸­HashMapMutableKey

```
// æ‰“å°å‡ºçš„ç»“æœï¼Œå¯è§æ”¹äº†mapçš„å±æ€§åï¼Œéœ€è¦é‡æ–°è®¡ç®—hashcodeå€¼ï¼ŒåŸæ¥çš„æ‰¾ä¸åˆ°äº†ï¼ŒæŸ¥æ‰¾çš„å°±æ˜¯null.
java.lang.Object@3d71d552
null
```

**String å¯¹è±¡çš„ hashCode() è®¾è®¡**

* ç›®æ ‡æ˜¯è¾¾åˆ°è¾ƒä¸ºå‡åŒ€çš„æ•£åˆ—æ•ˆæœï¼Œæ¯ä¸ªå­—ç¬¦ä¸²çš„ hashCode è¶³å¤Ÿç‹¬ç‰¹
* å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦éƒ½å¯ä»¥è¡¨ç°ä¸ºä¸€ä¸ªæ•°å­—ï¼Œç§°ä¸º $S_i$ï¼Œå…¶ä¸­ i çš„èŒƒå›´æ˜¯ 0 ~ n - 1 
* æ•£åˆ—å…¬å¼ä¸ºï¼š $S_0âˆ—31^{(n-1)}+ S_1âˆ—31^{(n-2)}+ â€¦ S_i âˆ— 31^{(n-1-i)}+ â€¦S_{(n-1)}âˆ—31^0$
* â‘ 31 ä»£å…¥å…¬å¼æœ‰è¾ƒå¥½çš„æ•£åˆ—ç‰¹æ€§ï¼Œâ‘¡å¹¶ä¸” 31 * h å¯ä»¥è¢«ä¼˜åŒ–ä¸º 
  * å³ $32 âˆ—h -h $
  * å³ $2^5  âˆ—h -h$
  * å³ $hâ‰ª5  -h$

å¯çœ‹åˆ°hashcodeä¸º31æ—¶ï¼Œæ•£åˆ—æ•ˆæœæ¯”è¾ƒå¥½
![](/assets/img/ext-img/hashmap-31.jpg)       
![](/assets/img/ext-img/hashmap-31-11.jpg)

## 11. å•ä¾‹æ¨¡å¼

**è¦æ±‚**

* æŒæ¡äº”ç§å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼
* ç†è§£ä¸ºä½• DCL å®ç°æ—¶è¦ä½¿ç”¨ volatile ä¿®é¥°é™æ€å˜é‡
* äº†è§£ jdk ä¸­ç”¨åˆ°å•ä¾‹çš„åœºæ™¯

### é¥¿æ±‰å¼

```java
public class Singleton1 implements Serializable {
    private Singleton1() {
        if (INSTANCE != null) {
            throw new RuntimeException("å•ä¾‹å¯¹è±¡ä¸èƒ½é‡å¤åˆ›å»º");
        }
        System.out.println("private Singleton1()");
    }

    private static final Singleton1 INSTANCE = new Singleton1();

    public static Singleton1 getInstance() {
        return INSTANCE;
    }

    public static void otherMethod() {
        System.out.println("otherMethod()");
    }

    public Object readResolve() {
        return INSTANCE;
    }
}
```

* æ„é€ æ–¹æ³•æŠ›å‡ºå¼‚å¸¸æ˜¯é˜²æ­¢åå°„ç ´åå•ä¾‹
* `readResolve()` æ˜¯é˜²æ­¢ååºåˆ—åŒ–ç ´åå•ä¾‹



### æšä¸¾é¥¿æ±‰å¼

```java
public enum Singleton2 {
    INSTANCE;

    private Singleton2() {
        System.out.println("private Singleton2()");
    }

    @Override
    public String toString() {
        return getClass().getName() + "@" + Integer.toHexString(hashCode());
    }

    public static Singleton2 getInstance() {
        return INSTANCE;
    }

    public static void otherMethod() {
        System.out.println("otherMethod()");
    }
}
```

* æšä¸¾é¥¿æ±‰å¼èƒ½å¤©ç„¶é˜²æ­¢åå°„ã€ååºåˆ—åŒ–ç ´åå•ä¾‹



### æ‡’æ±‰å¼

```java
public class Singleton3 implements Serializable {
    private Singleton3() {
        System.out.println("private Singleton3()");
    }

    private static Singleton3 INSTANCE = null;

    // Singleton3.class
    public static synchronized Singleton3 getInstance() {
        if (INSTANCE == null) {
            INSTANCE = new Singleton3();
        }
        return INSTANCE;
    }

    public static void otherMethod() {
        System.out.println("otherMethod()");
    }

}
```

* å…¶å®åªæœ‰é¦–æ¬¡åˆ›å»ºå•ä¾‹å¯¹è±¡æ—¶æ‰éœ€è¦åŒæ­¥ï¼Œä½†è¯¥ä»£ç å®é™…ä¸Šæ¯æ¬¡è°ƒç”¨éƒ½ä¼šåŒæ­¥
* å› æ­¤æœ‰äº†ä¸‹é¢çš„åŒæ£€é”æ”¹è¿›



### åŒæ£€é”æ‡’æ±‰å¼

```java
public class Singleton4 implements Serializable {
    private Singleton4() {
        System.out.println("private Singleton4()");
    }

    private static volatile Singleton4 INSTANCE = null; // å¯è§æ€§ï¼Œæœ‰åºæ€§

    public static Singleton4 getInstance() {
        if (INSTANCE == null) {
            synchronized (Singleton4.class) {
                if (INSTANCE == null) {
                    INSTANCE = new Singleton4();
                }
            }
        }
        return INSTANCE;
    }

    public static void otherMethod() {
        System.out.println("otherMethod()");
    }
}
```

ä¸ºä½•å¿…é¡»åŠ  volatileï¼š

* `INSTANCE = new Singleton4()` ä¸æ˜¯åŸå­çš„ï¼Œåˆ†æˆ 3 æ­¥ï¼šåˆ›å»ºå¯¹è±¡ã€è°ƒç”¨æ„é€ ã€ç»™é™æ€å˜é‡èµ‹å€¼ï¼Œå…¶ä¸­åä¸¤æ­¥å¯èƒ½è¢«æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼Œå˜æˆå…ˆèµ‹å€¼ã€å†è°ƒç”¨æ„é€ 
* å¦‚æœçº¿ç¨‹1 å…ˆæ‰§è¡Œäº†èµ‹å€¼ï¼Œçº¿ç¨‹2 æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ª `INSTANCE == null` æ—¶å‘ç° INSTANCE å·²ç»ä¸ä¸º nullï¼Œæ­¤æ—¶å°±ä¼šè¿”å›ä¸€ä¸ªæœªå®Œå…¨æ„é€ çš„å¯¹è±¡



### å†…éƒ¨ç±»æ‡’æ±‰å¼

```java
public class Singleton5 implements Serializable {
    private Singleton5() {
        System.out.println("private Singleton5()");
    }

    private static class Holder {
        static Singleton5 INSTANCE = new Singleton5();
    }

    public static Singleton5 getInstance() {
        return Holder.INSTANCE;
    }

    public static void otherMethod() {
        System.out.println("otherMethod()");
    }
}
```

* é¿å…äº†åŒæ£€é”çš„ç¼ºç‚¹



**JDK ä¸­å•ä¾‹çš„ä½“ç°**

* Runtime ä½“ç°äº†é¥¿æ±‰å¼å•ä¾‹
* Console ä½“ç°äº†åŒæ£€é”æ‡’æ±‰å¼å•ä¾‹
* Collections ä¸­çš„ EmptyNavigableSet å†…éƒ¨ç±»æ‡’æ±‰å¼å•ä¾‹
* ReverseComparator.REVERSE_ORDER å†…éƒ¨ç±»æ‡’æ±‰å¼å•ä¾‹
* Comparators.NaturalOrderComparator.INSTANCE æšä¸¾é¥¿æ±‰å¼å•ä¾‹